name: "Coverage"
on:
  push:
    branches: [develop, ch-setup-integration-18]

jobs:
  check_pr:
    runs-on: ubuntu-latest
    steps:
    - name: checkout code
      uses: actions/checkout@v3

    - name: install dependencies
      run: npm install

    - name: build typescript
      run: npm run build

    - name: run tests and instrument coverage
      run: npm run test

   - name: Upload coverage to Codecov
      uses: codecov/codecov-action@v2
      env:
        CI: "true"
        CC_TEST_REPORTER_ID: ${{secrets.CC_TEST_REPORTER_ID}}
      with:
        debug: true
        coverageCommand: npm run coverage

